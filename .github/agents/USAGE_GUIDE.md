# カスタムエージェント使用ガイド

このドキュメントでは、`site-reviewer` カスタムエージェントの効果的な使用方法を説明します。

## site-reviewer エージェントとは

`site-reviewer`は、このAstro + TypeScriptベースのクイズサイトプロジェクト専用に設計されたGitHub Copilotカスタムエージェントです。プロジェクトの構成、コード品質、パフォーマンス、セキュリティなど、多岐にわたる観点から包括的なレビューを提供します。

## セットアップ

### 前提条件
- GitHub Copilot のサブスクリプション
- VS Code または GitHub.com でのCopilot Chat へのアクセス

### エージェントの有効化
カスタムエージェントは、`.github/agents/`ディレクトリに配置されると自動的にGitHub Copilotに認識されます。追加の設定は不要です。

## 基本的な使用方法

### 1. エージェントの呼び出し

Copilot Chatで`@site-reviewer`と入力してエージェントを呼び出します：

```
@site-reviewer こんにちは
```

### 2. プロジェクト全体のレビュー

```
@site-reviewer プロジェクト全体の構成をレビューして、ベストプラクティスに基づいた改善提案をしてください
```

## 実践的な使用例

### シナリオ 1: 新機能追加前のレビュー

新しい機能を追加する前に、現在のコードベースの状態を確認：

```
@site-reviewer 現在のContent Collectionsのスキーマ設計をレビューし、新しいクイズタイプを追加する際の拡張性について助言してください
```

### シナリオ 2: パフォーマンス最適化

サイトのパフォーマンスを改善したい場合：

```
@site-reviewer サイトのパフォーマンスを評価し、Lighthouseスコアを改善するための具体的な提案をしてください
```

### シナリオ 3: アクセシビリティ向上

アクセシビリティを改善したい場合：

```
@site-reviewer クイズページのアクセシビリティをWCAG 2.1 AA基準で評価し、改善点を提案してください
```

### シナリオ 4: CI/CDパイプラインの最適化

GitHub Actionsワークフローを改善したい場合：

```
@site-reviewer .github/workflows/deploy.yml のCI/CDパイプラインをレビューし、ビルド時間短縮とコスト削減の提案をしてください
```

### シナリオ 5: セキュリティ監査

セキュリティの確認を行いたい場合：

```
@site-reviewer プロジェクトのセキュリティ設定をレビューし、潜在的な脆弱性や改善点を指摘してください
```

### シナリオ 6: TypeScript型定義のレビュー

TypeScriptの型定義を改善したい場合：

```
@site-reviewer src/content/config.ts のZodスキーマをレビューし、型安全性を向上させる提案をしてください
```

### シナリオ 7: コードリファクタリング

既存のコードをリファクタリングする際：

```
@site-reviewer src/pages/quiz/[id].astro のコンポーネント設計をレビューし、再利用性とメンテナンス性を向上させる方法を提案してください
```

### シナリオ 8: SEO改善

SEOを強化したい場合：

```
@site-reviewer サイトのSEO設定をレビューし、検索エンジンでの可視性を向上させる具体的な施策を提案してください
```

## レビュー結果の活用

### 優先順位の理解

エージェントは改善提案を以下の優先度で分類します：

- **高**: セキュリティ、パフォーマンス、アクセシビリティに重大な影響
- **中**: コード品質、メンテナンス性の向上
- **低**: コーディングスタイル、ドキュメント改善

### 段階的な実装

1. **高優先度の課題から対応**
2. **各改善を個別にテスト**
3. **変更をコミット前にレビュー**
4. **定期的にエージェントで再レビュー**

## ベストプラクティス

### 1. 定期的なレビュー
- 新機能開発前
- リリース前
- 大規模なリファクタリング前

### 2. 具体的な質問
一般的な質問よりも、具体的な質問の方が有益な回答が得られます：

**良い例**:
```
@site-reviewer Content Collectionsでカテゴリーとタグのサポートを追加したい場合、スキーマをどのように拡張すべきですか？
```

**避けるべき例**:
```
@site-reviewer コードをレビューして
```

### 3. コンテキストの提供
レビューを依頼する際は、背景情報を提供すると、より的確な提案が得られます：

```
@site-reviewer ユーザーから「クイズのカテゴリー検索機能が欲しい」というフィードバックを受けました。現在のContent Collectionsにカテゴリー機能を追加する最適な方法を提案してください。
```

### 4. フォローアップ質問
エージェントの提案について不明点があれば、フォローアップ質問をしましょう：

```
提案されたZodスキーマの変更について、既存のクイズデータとの互換性はどうなりますか？
```

## トラブルシューティング

### エージェントが応答しない場合
1. `@site-reviewer`の前に空白がないか確認
2. GitHub Copilotが有効になっているか確認
3. リポジトリが正しく開かれているか確認

### 予期しない回答が返ってくる場合
1. 質問をより具体的にする
2. レビュー範囲を明確にする
3. 関連するファイルパスを指定する

## よくある質問

### Q: エージェントは何をレビューできますか？
A: Astroプロジェクト構成、TypeScriptコード、Content Collections、CI/CD、セキュリティ、アクセシビリティ、パフォーマンス、SEOなど、幅広い領域をレビューできます。

### Q: エージェントは自動的にコードを修正しますか？
A: いいえ。エージェントは提案とコード例を提供しますが、実装は開発者が行う必要があります。

### Q: どのくらいの頻度でレビューすべきですか？
A: 新機能追加時、リリース前、大規模な変更後など、重要なマイルストーンでレビューすることを推奨します。

### Q: エージェントをカスタマイズできますか？
A: はい。`.github/agents/site-reviewer.agent.yml`を編集して、レビュー範囲や指示をカスタマイズできます。

## 参考リンク

- [GitHub Copilot ドキュメント](https://docs.github.com/en/copilot)
- [カスタムエージェントの作成](https://docs.github.com/en/copilot/customizing-copilot/creating-custom-agents)
- [Astro公式ドキュメント](https://docs.astro.build/)
- [TypeScriptベストプラクティス](https://www.typescriptlang.org/docs/handbook/declaration-files/do-s-and-don-ts.html)

## フィードバック

このカスタムエージェントの改善提案やバグ報告は、GitHubのIssueまたはPull Requestでお願いします。
